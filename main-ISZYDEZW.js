import{a as qe,b as H}from"./chunk-JAJHWOKX.js";import{c as _e,d as V,g as Ae,h as xe}from"./chunk-YWN4MWLT.js";import{A as q,B as Ne,C as je,D as Le,E as Be,F as z,I as $,b as Ue,z as Fe}from"./chunk-JHEYQFVQ.js";import{$ as P,A as re,B as G,U as We,W as Ve,_ as Ge,g as Me,i as Pe,ja as et,l as Re,m as te}from"./chunk-NC7CJBZN.js";import{$a as E,A as d,Ab as N,B as C,Gb as Ee,I as T,Ib as j,Jb as Ie,Ra as v,T as f,X as g,Y as ce,Yb as L,Zb as B,_ as h,ba as pe,c as x,ca as J,da as i,db as he,ea as le,f as U,fb as ve,ia as de,ib as be,ic as M,ja as fe,jc as W,ka as ue,kc as Se,mc as ke,nb as F,pa as me,pb as ee,q as m,qb as ye,r as se,rb as we,sb as De,ua as ge,vb as Ce,wb as Te,xb as O,xc as Oe,yb as u,zb as b}from"./chunk-DX3VH5IT.js";import{a as ae,f as Je}from"./chunk-HZ6M6AS2.js";var ne="Service workers are disabled or not supported by this browser",I=class{serviceWorker;worker;registration;events;constructor(r,e){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=new x(n=>n.error(new g(5601,!1)));else{let n=null,t=new U;this.worker=new x(c=>(n!==null&&c.next(n),t.subscribe(A=>c.next(A))));let a=()=>{let{controller:c}=r;c!==null&&(n=c,t.next(n))};r.addEventListener("controllerchange",a),a(),this.registration=this.worker.pipe(f(()=>r.getRegistration().then(c=>{if(!c)throw new g(5601,!1);return c})));let s=new U;this.events=s.asObservable();let p=c=>{let{data:A}=c;A?.type&&s.next(A)};r.addEventListener("message",p),e?.get(ee,null,{optional:!0})?.onDestroy(()=>{r.removeEventListener("controllerchange",a),r.removeEventListener("message",p)})}}postMessage(r,e){return new Promise(n=>{this.worker.pipe(T(1)).subscribe(t=>{t.postMessage(ae({action:r},e)),n()})})}postMessageWithOperation(r,e,n){let t=this.waitForOperationCompleted(n),a=this.postMessage(r,e);return Promise.all([a,t]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let e;return typeof r=="string"?e=n=>n.type===r:e=n=>r.includes(n.type),this.events.pipe(C(e))}nextEventOfType(r){return this.eventsOfType(r).pipe(T(1))}waitForOperationCompleted(r){return new Promise((e,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(C(t=>t.nonce===r),T(1),m(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).subscribe({next:e,error:n})})}get isEnabled(){return!!this.serviceWorker}},tt=(()=>{class o{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new U;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=d,this.notificationClicks=d,this.notificationCloses=d,this.pushSubscriptionChanges=d,this.subscription=d;return}this.messages=this.sw.eventsOfType("PUSH").pipe(m(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(m(t=>t.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(m(t=>t.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(m(t=>t.data)),this.pushManager=this.sw.registration.pipe(m(t=>t.pushManager));let n=this.pushManager.pipe(f(t=>t.getSubscription()));this.subscription=new x(t=>{let a=n.subscribe(t),s=this.subscriptionChanges.subscribe(t);return()=>{a.unsubscribe(),s.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(ne));let n={userVisibleOnly:!0},t=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(t.length));for(let s=0;s<t.length;s++)a[s]=t.charCodeAt(s);return n.applicationServerKey=a,new Promise((s,p)=>{this.pushManager.pipe(f(l=>l.subscribe(n)),T(1)).subscribe({next:l=>{this.subscriptionChanges.next(l),s(l)},error:p})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(ne));let e=n=>{if(n===null)throw new g(5602,!1);return n.unsubscribe().then(t=>{if(!t)throw new g(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,t)=>{this.subscription.pipe(T(1),f(e)).subscribe({next:n,error:t})})}decodeBase64(e){return atob(e)}static \u0275fac=function(n){return new(n||o)(J(I))};static \u0275prov=h({token:o,factory:o.\u0275fac})}return o})(),oe=(()=>{class o{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=d,this.unrecoverable=d;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(ne));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new g(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(n){return new(n||o)(J(I))};static \u0275prov=h({token:o,factory:o.\u0275fac})}return o})();var $e=new pe("");function rt(){let o=i(R);if(!("serviceWorker"in navigator&&o.enabled!==!1))return;let r=i($e),e=i(be),n=i(ee);e.runOutsideAngular(()=>{let t=navigator.serviceWorker,a=()=>t.controller?.postMessage({action:"INITIALIZE"});t.addEventListener("controllerchange",a),n.onDestroy(()=>{t.removeEventListener("controllerchange",a)})}),e.runOutsideAngular(()=>{let t,{registrationStrategy:a}=o;if(typeof a=="function")t=new Promise(s=>a().subscribe(()=>s()));else{let[s,...p]=(a||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":t=Promise.resolve();break;case"registerWithDelay":t=ze(+p[0]||0);break;case"registerWhenStable":t=Promise.race([n.whenStable(),ze(+p[0])]);break;default:throw new g(5600,!1)}}t.then(()=>{n.destroyed||navigator.serviceWorker.register(r,{scope:o.scope}).catch(s=>console.error(ce(5604,!1)))})})}function ze(o){return new Promise(r=>setTimeout(r,o))}function nt(o,r){return new I(o.enabled!==!1?navigator.serviceWorker:void 0,r)}var R=class{enabled;scope;registrationStrategy};function He(o,r={}){return le([tt,oe,{provide:$e,useValue:o},{provide:R,useValue:r},{provide:I,useFactory:nt,deps:[R,ue]},F(rt)])}var ot=(o,r)=>r.value;function it(o,r){o&1&&N(0,"fa-icon",1),o&2&&O("icon",r)}function at(o,r){if(o&1){let e=Ee();u(0,"button",4),j("click",function(){let t=de(e).$implicit,a=Ie();return fe(a.dialogRef.close(t.value))}),b()}if(o&2){let e=r.$implicit,n=r.$index,t=r.$count;O("color",e.color??(n===t-1?"brand":"gray"))("faIcon",e.icon)("text",e.text)}}var S=class S{constructor(){this.dialogData=i(Ne);this.dialogRef=i(q)}};S.\u0275fac=function(e){return new(e||S)},S.\u0275cmp=E({type:S,selectors:[["lab-confirm-dialog"]],hostAttrs:[1,"flex","flex-col","gap-3","sm:gap-6","p-3","sm:p-6","pt-0","sm:pt-0","lg:max-w-3xl"],decls:8,vars:4,consts:[[1,"flex","gap-1","sm:gap-2"],["size","xl",3,"icon"],[1,"flex","justify-end","gap-1","sm:gap-2"],["type","button","labButton","",3,"color","faIcon","text"],["type","button","labButton","",3,"click","color","faIcon","text"]],template:function(e,n){if(e&1&&(u(0,"div",0),we(1,it,1,1,"fa-icon",1),u(2,"p"),L(3),M(4,"translate"),b()(),u(5,"div",2),Ce(6,at,1,3,"button",3,ot),b()),e&2){let t;v(),De((t=n.dialogData.icon)?1:-1,t),v(2),B(W(4,2,n.dialogData.message)),v(3),Te(n.dialogData.actions)}},dependencies:[Be,$,z],encapsulation:2,changeDetection:0});var K=S;var y=class y{constructor(){this.dialog=i(Le)}show(r){return this.dialog.open(K,{data:r}).closed}};y.\u0275fac=function(e){return new(e||y)},y.\u0275prov=h({token:y,factory:y.\u0275fac,providedIn:"root"});var X=y;var w=class w{reload(){window.location.reload()}};w.\u0275fac=function(e){return new(e||w)},w.\u0275prov=h({token:w,factory:w.\u0275fac,providedIn:"root"});var Z=w;var k=class k{constructor(){this.swUpdate=i(oe);this.confirm=i(X);this.windowClient=i(Z);se([this.swUpdate.unrecoverable.pipe(f(()=>this.confirm.show({header:"app.updateRequired",message:"app.updateRequiredMessage",icon:te,actions:[{text:"ok",icon:re}]}))),this.swUpdate.versionUpdates.pipe(C(r=>r.type==="VERSION_READY"),f(()=>this.confirm.show({header:"app.updateAvailable",message:"app.updateAvailableMessage",icon:te,actions:[{text:"cancel",value:!1,icon:G},{text:"ok",value:!0,icon:re}]})),C(r=>!!r))]).pipe(Re()).subscribe(()=>{this.windowClient.reload()})}};k.\u0275fac=function(e){return new(e||k)},k.\u0275cmp=E({type:k,selectors:[["lab-root"]],hostAttrs:[1,"block","h-full"],decls:1,vars:0,template:function(e,n){e&1&&N(0,"router-outlet")},dependencies:[_e],encapsulation:2});var Y=k;var Ye=Je(et(),1);function st(o,r){}var D=class D extends Fe{constructor(){super(...arguments);this.dialogRef=i(q);this.faXmark=G}ngOnInit(){this.parseData()}parseData(){let e=this.dialogRef.config.data;if(e==null||typeof e!="object")return;let n=e.header;typeof n=="string"?this.header=n:typeof n=="object"&&([this.header,this.headerParams]=[...n])}};D.\u0275fac=(()=>{let e;return function(t){return(e||(e=ge(D)))(t||D)}})(),D.\u0275cmp=E({type:D,selectors:[["lab-dialog"]],hostAttrs:[1,"flex","flex-col","bg-gray-950","border","border-gray-700","w-dvw-1","sm:w-dvw-3","lg:w-auto","rounded-xs","starting:opacity-0","starting:translate-y-40","transition-all"],features:[he],decls:7,vars:9,consts:[[1,"flex","items-center","justify-between","p-3","sm:p-6"],[1,"text-lg","font-semibold"],["type","button","labButton","",3,"click","faIcon","border"],["cdkPortalOutlet",""]],template:function(n,t){n&1&&(u(0,"div",0)(1,"h2",1),L(2),M(3,"translate"),b(),u(4,"button",2),M(5,"translate"),j("click",function(){return t.dialogRef.close()}),b()(),ve(6,st,0,0,"ng-template",3)),n&2&&(v(2),B(Se(3,4,t.header,t.headerParams)),v(2),O("faIcon",t.faXmark)("border",!1),ye("aria-label",W(5,7,"close")))},dependencies:[Ue,$,z],encapsulation:2,changeDetection:0});var Q=D;var Xe=o=>{let r=i(V),e=i(qe),n=i(H),t=o.params.id;switch(t){case"list":case"wizard":case"flow":case"data":return(async()=>{let s=await n.unzipQueryParams(o.queryParams),{modId:p,params:l}=e.migrate(void 0,s),c=l.z?await n.getHashParams(l):l;return r.createUrlTree([Ve(p,"1.1"),t],{queryParams:c})})();case"factorio":return r.createUrlTree([P]);case"final-factory":return r.createUrlTree(["ffy"]);case"foundry":return r.createUrlTree(["fdy"]);case"outworld-station":return r.createUrlTree(["ows"]);case"satisfactory":return r.createUrlTree(["sfy"]);case"techtonica":return r.createUrlTree(["tta"])}return!0};var ie=o=>{let r=i(V);if(i(We).bypassLanding()){let n=i(H).stored();if(n&&Object.keys(o.params).length===0&&Object.keys(o.queryParams).length===0)return r.parseUrl(n);let t=o.paramMap.get("id")??P;return r.createUrlTree([t,"list"],{queryParams:o.queryParams})}return o.params.id==null?r.createUrlTree([P]):!0};var Ze=[{path:":id",canActivate:[Xe],loadComponent:()=>import("./chunk-2OCDATWJ.js").then(o=>o.Id),children:[{path:"",pathMatch:"full",canActivate:[ie],loadComponent:()=>import("./chunk-UB3IZOKF.js").then(o=>o.Landing)},{path:"",loadComponent:()=>import("./chunk-KCB7FI7W.js").then(o=>o.Main),loadChildren:()=>import("./chunk-XOSIOYI3.js").then(o=>o.routes)}]},{path:"**",canActivate:[ie],children:[]}];var ct={container:Q,hasBackdrop:!0};async function pt(){return i(Ge).load(),(0,Ye.loadModule)("glpk.all.wasm")}var Qe={providers:[{provide:je,useValue:ct},F(()=>pt()),me(),ke(),Ae(Ze,xe()),Pe(),He("ngsw-worker.js",{enabled:!Oe(),registrationStrategy:"registerWhenStable:30000"})]};Me(Y,Qe).catch(o=>{console.error(o)});
