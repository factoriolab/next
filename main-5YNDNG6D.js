import{a as De,b as v}from"./chunk-PN4XAX2T.js";import{$ as ve,B as fe,C as me,E as ge,G as Ue,O as he,ba as be,c as ae,d as ce,da as ye,ea as we,g as pe,h,j as le,ja as C,k as ue,l as de,qa as Ce}from"./chunk-UFM5MYDC.js";import{A as I,Db as ee,H as g,Qa as U,S as d,Sb as te,Tb as re,W as f,X as G,Z as R,_a as S,aa as V,ba as A,bc as j,c as T,ca as a,cb as Z,cc as ne,da as q,dc as ie,eb as X,f as O,fc as oe,hb as $,ja as z,k as B,mb as M,oa as H,ob as _,pb as Q,q as p,qc as se,ta as K,vb as Y,wb as F,xb as N,yb as J,z as l}from"./chunk-JKUCHHSZ.js";import{a as W,f as Ae}from"./chunk-HZ6M6AS2.js";var b=class b{};b.\u0275fac=function(t){return new(t||b)},b.\u0275cmp=S({type:b,selectors:[["lab-root"]],hostAttrs:[1,"block","h-full"],decls:1,vars:0,template:function(t,r){t&1&&J(0,"router-outlet")},dependencies:[pe],encapsulation:2});var P=b;var x="Service workers are disabled or not supported by this browser",y=class{serviceWorker;worker;registration;events;constructor(n,t){if(this.serviceWorker=n,!n)this.worker=this.events=this.registration=new T(r=>r.error(new f(5601,!1)));else{let r=null,e=new O;this.worker=new T(c=>(r!==null&&c.next(r),e.subscribe(E=>c.next(E))));let o=()=>{let{controller:c}=n;c!==null&&(r=c,e.next(r))};n.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(d(()=>n.getRegistration().then(c=>{if(!c)throw new f(5601,!1);return c})));let s=new O;this.events=s.asObservable();let u=c=>{let{data:E}=c;E?.type&&s.next(E)};n.addEventListener("message",u),t?.get(_,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",o),n.removeEventListener("message",u)})}}postMessage(n,t){return new Promise(r=>{this.worker.pipe(g(1)).subscribe(e=>{e.postMessage(W({action:n},t)),r()})})}postMessageWithOperation(n,t,r){let e=this.waitForOperationCompleted(r),o=this.postMessage(n,t);return Promise.all([o,e]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(n){let t;return typeof n=="string"?t=r=>r.type===n:t=r=>n.includes(r.type),this.events.pipe(I(t))}nextEventOfType(n){return this.eventsOfType(n).pipe(g(1))}waitForOperationCompleted(n){return new Promise((t,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(I(e=>e.nonce===n),g(1),p(e=>{if(e.result!==void 0)return e.result;throw new Error(e.error)})).subscribe({next:t,error:r})})}get isEnabled(){return!!this.serviceWorker}},Fe=(()=>{class i{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new O;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=l,this.notificationClicks=l,this.notificationCloses=l,this.pushSubscriptionChanges=l,this.subscription=l;return}this.messages=this.sw.eventsOfType("PUSH").pipe(p(e=>e.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(p(e=>e.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(p(e=>e.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(p(e=>e.data)),this.pushManager=this.sw.registration.pipe(p(e=>e.pushManager));let r=this.pushManager.pipe(d(e=>e.getSubscription()));this.subscription=new T(e=>{let o=r.subscribe(e),s=this.subscriptionChanges.subscribe(e);return()=>{o.unsubscribe(),s.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(x));let r={userVisibleOnly:!0},e=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(e.length));for(let s=0;s<e.length;s++)o[s]=e.charCodeAt(s);return r.applicationServerKey=o,new Promise((s,u)=>{this.pushManager.pipe(d(w=>w.subscribe(r)),g(1)).subscribe({next:w=>{this.subscriptionChanges.next(w),s(w)},error:u})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=r=>{if(r===null)throw new f(5602,!1);return r.unsubscribe().then(e=>{if(!e)throw new f(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,e)=>{this.subscription.pipe(g(1),d(t)).subscribe({next:r,error:e})})}decodeBase64(t){return atob(t)}static \u0275fac=function(r){return new(r||i)(A(y))};static \u0275prov=R({token:i,factory:i.\u0275fac})}return i})(),Ne=(()=>{class i{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=l,this.unrecoverable=l;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let t=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new f(5601,!1));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(r){return new(r||i)(A(y))};static \u0275prov=R({token:i,factory:i.\u0275fac})}return i})();var Oe=new V("");function je(){let i=a(D);if(!("serviceWorker"in navigator&&i.enabled!==!1))return;let n=a(Oe),t=a($),r=a(_);t.runOutsideAngular(()=>{let e=navigator.serviceWorker,o=()=>e.controller?.postMessage({action:"INITIALIZE"});e.addEventListener("controllerchange",o),r.onDestroy(()=>{e.removeEventListener("controllerchange",o)})}),t.runOutsideAngular(()=>{let e,{registrationStrategy:o}=i;if(typeof o=="function")e=new Promise(s=>o().subscribe(()=>s()));else{let[s,...u]=(o||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":e=Promise.resolve();break;case"registerWithDelay":e=Te(+u[0]||0);break;case"registerWhenStable":e=Promise.race([r.whenStable(),Te(+u[0])]);break;default:throw new f(5600,!1)}}e.then(()=>{r.destroyed||navigator.serviceWorker.register(n,{scope:i.scope}).catch(s=>console.error(G(5604,!1)))})})}function Te(i){return new Promise(n=>setTimeout(n,i))}function xe(i,n){return new y(i.enabled!==!1?navigator.serviceWorker:void 0,n)}var D=class{enabled;scope;registrationStrategy};function Se(i,n={}){return q([Fe,Ne,{provide:Oe,useValue:i},{provide:D,useValue:n},{provide:y,useFactory:xe,deps:[D,z]},M(je)])}var Ie=Ae(Ue(),1);function Le(i,n){}var m=class m extends fe{constructor(){super(...arguments);this.dialogRef=a(me);this.faXmark=he}ngOnInit(){this.parseData()}parseData(){let t=this.dialogRef.config.data;if(t==null||typeof t!="object")return;let r=t.header;typeof r=="string"?this.header=r:typeof r=="object"&&([this.header,this.headerParams]=[...r])}};m.\u0275fac=(()=>{let t;return function(e){return(t||(t=K(m)))(e||m)}})(),m.\u0275cmp=S({type:m,selectors:[["lab-dialog"]],hostAttrs:[1,"flex","flex-col","bg-gray-950","border","border-gray-700"],features:[Z],decls:7,vars:8,consts:[[1,"flex","justify-between","p-3"],[1,"text-lg","font-semibold"],["type","button","labButton","",3,"click","faIcon"],["cdkPortalOutlet",""]],template:function(r,e){r&1&&(F(0,"div",0)(1,"h2",1),te(2),j(3,"translate"),N(),F(4,"button",2),j(5,"translate"),ee("click",function(){return e.dialogRef.close()}),N()(),X(6,Le,0,0,"ng-template",3)),r&2&&(U(2),re(ie(3,3,e.header,e.headerParams)),U(2),Y("faIcon",e.faXmark),Q("aria-label",ne(5,6,"close")))},dependencies:[de,Ce,we],encapsulation:2,changeDetection:0});var k=m;var Me=i=>{let n=a(h),t=a(De),r=a(v),e=i.params.id;switch(e){case"list":case"wizard":case"flow":case"data":return B(r.unzipQueryParams(i.queryParams)).pipe(p(o=>t.migrate(void 0,o)),d(async({modId:o,params:s})=>(s.z&&(s=await r.getHashParams(s)),n.createUrlTree([be(o,"1.1"),e],{queryParams:s}))));case"factorio":return n.createUrlTree([C]);case"final-factory":return n.createUrlTree(["ffy"]);case"foundry":return n.createUrlTree(["fdy"]);case"outworld-station":return n.createUrlTree(["ows"]);case"satisfactory":return n.createUrlTree(["sfy"]);case"techtonica":return n.createUrlTree(["tta"])}return r.route$.next(i),!0};var L=i=>{let n=a(h);if(a(ve).bypassLanding()){let r=a(v).stored();if(r&&Object.keys(i.params).length===0&&Object.keys(i.queryParams).length===0)return n.parseUrl(r);let e=i.paramMap.get("id")??C;return n.createUrlTree([e,"list"],{queryParams:i.queryParams})}return i.params.id==null?n.createUrlTree([C]):!0};var Pe=i=>{let n=a(h),t=a(v),e={o:Object.keys(i.queryParams).map(o=>`${o}*0.5`),odr:"0",v:t.version};return n.createUrlTree(["..","list"],{queryParams:e})};var ke=[{path:":id",canActivate:[Me],children:[{path:"ratio",canActivate:[Pe],children:[]},{path:"",pathMatch:"full",canActivate:[L],loadComponent:()=>import("./chunk-SCIS36IY.js").then(i=>i.Landing)},{path:"",loadComponent:()=>import("./chunk-WZYOKUZT.js").then(i=>i.Main),loadChildren:()=>import("./chunk-W3VFPVML.js").then(i=>i.routes)}]},{path:"**",canActivate:[L],children:[]}];var We={container:k,hasBackdrop:!0};async function Be(){return a(ye).load(),(0,Ie.loadModule)("glpk.all.wasm")}var Re={providers:[{provide:ge,useValue:We},M(()=>Be()),H(),oe(),le(ke,ue()),ce(),Se("ngsw-worker.js",{enabled:!se(),registrationStrategy:"registerWhenStable:30000"})]};ae(P,Re).catch(i=>{console.error(i)});
